#! /bin/sh /usr/share/dpatch/dpatch-run
## 30-invoke-rc.dpatch by  <math.parent@gmail.com>
##
## DP: Debian specific invocation of services

@DPATCH@
diff -urNad kolabconf-2.2~rc1+20080204~/lib/Kolab/Conf.pm kolabconf-2.2~rc1+20080204/lib/Kolab/Conf.pm
--- kolabconf-2.2~rc1+20080204~/lib/Kolab/Conf.pm	2008-02-17 21:22:21.000000000 +0100
+++ kolabconf-2.2~rc1+20080204/lib/Kolab/Conf.pm	2008-02-17 21:26:05.000000000 +0100
@@ -724,22 +724,22 @@
 {
     if ($haschanged{'slapd'}) {
         &Kolab::log('K', 'Restarting OpenLDAP...');
-        system("$Kolab::config{'KOLABRC'} rc openldap restart &");
+        system("invoke-rc.d slapd restart &");
     }
 
     if ($haschanged{'saslauthd'}) {
         &Kolab::log('K', 'Restarting SASLAuthd...');
-        system("$Kolab::config{'KOLABRC'} rc sasl stop; sleep 1; $Kolab::config{sbindir}/saslauthd -a ldap -n 5");
+        system("invoke-rc.d saslauthd restart");
     }
 
     if ($haschanged{'apache'}) {
         &Kolab::log('K', 'Reloading Apache...');
-        system("$Kolab::config{sbindir}/apachectl graceful");
+        system("invoke-rc.d apache2 graceful");
     }
 
     if ($haschanged{'postfix'}) {
         &Kolab::log('K', 'Reloading Postfix...');
-        system("$Kolab::config{sbindir}/postfix reload");
+        system("invoke-rc.d postfix reload");
     }
 
     if ($haschanged{'imapd'}) {
@@ -748,16 +748,6 @@
         system("$Kolab::config{'KOLABRC'} rc imapd restart");
     }
 
-    if ($haschanged{'amavisd'}) {
-        &Kolab::log('K', 'Restarting amavisd...');
-        system("$Kolab::config{'KOLABRC'} rc amavisd restart");
-    }
-
-    if ($haschanged{'clamav'}) {
-        &Kolab::log('K', 'Restarting clamav...');
-        system("$Kolab::config{'KOLABRC'} rc clamav restart");
-    }
-
     %Kolab::Conf::haschanged = ();
 
     &Kolab::log('K', 'Reload finished');
